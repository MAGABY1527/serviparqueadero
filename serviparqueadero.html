<script>
  function cargarDatos() {
    const params = new URLSearchParams(window.location.search);

    // Si no hay query (?a=b), intentamos con hash (#a=b)
    let hashParams = new URLSearchParams();
    if (!window.location.search && window.location.hash) {
      const hash = window.location.hash.replace(/^#/, '');
      hashParams = new URLSearchParams(hash);
    }

    // Helper: busca la clave en query, si no en hash, y tolera Mayus/Minus
    function getParamSmart(key) {
      const variants = [key, key.toLowerCase(), key.toUpperCase(), capitalize(key)];
      for (const k of variants) {
        if (params.has(k)) return params.get(k);
        if (hashParams.has(k)) return hashParams.get(k);
      }
      return "";
    }

    function capitalize(s){ return s ? s.charAt(0).toUpperCase() + s.slice(1) : s; }

    // Seteo de campos
    setText("fecha",    getParamSmart("fecha"));
    setText("norecibo", getParamSmart("norecibo"));
    setText("placa",    getParamSmart("placa"));
    setText("ingreso",  getParamSmart("ingreso"));
    setText("salida",   getParamSmart("salida"));
    setText("total",    getParamSmart("total"));

    // Precio opcional
    const precio = getParamSmart("precio");
    if (precio) {
      setText("precio", precio);
      const filaPrecio = document.getElementById("row-precio");
      if (filaPrecio) filaPrecio.classList.remove("hidden");
    }

    // Logo dinÃ¡mico
    const imagenRuta = getParamSmart("imagen");
    const imagenElement = document.getElementById("logoRecibo");
    if (imagenRuta) imagenElement.src = imagenRuta;

    // Imprime luego de pintar
    setTimeout(() => window.print(), 100);
  }

  function setText(id, value) {
    const el = document.getElementById(id);
    if (el) el.textContent = value || "";
  }
</script>
